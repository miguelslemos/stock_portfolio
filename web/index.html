<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' 'wasm-unsafe-eval'; 
                   style-src 'self' 'unsafe-inline'; 
                   connect-src 'self' https://olinda.bcb.gov.br; 
                   img-src 'self' data: blob:; 
                   font-src 'self'; 
                   object-src 'none'; 
                   base-uri 'self'; 
                   form-action 'self';" />
    <meta name="description" content="Sistema de gest√£o de portf√≥lio de a√ß√µes com c√°lculo autom√°tico de impostos e relat√≥rios detalhados" />
    <meta name="keywords" content="portf√≥lio, a√ß√µes, investimentos, imposto de renda, gest√£o financeira" />
    <title>Gest√£o de Portf√≥lio de A√ß√µes do NU | Stock Portfolio Manager</title>
    <link rel="stylesheet" href="/src/presentation/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üìà Stock Portfolio Management</h1>
        <p>Acompanhe suas opera√ß√µes de a√ß√µes da NU e gere relat√≥rios de imposto automaticamente</p>
        <div class="privacy-notice">
          <span class="privacy-icon">üîí</span>
          <span class="privacy-text">
            <strong>100% Privado e Seguro:</strong> Todos os PDFs s√£o processados localmente no seu navegador. 
            Apenas cota√ß√µes PTAX s√£o consultadas externamente. Seus dados nunca s√£o enviados ou armazenados.
          </span>
        </div>
      </header>

      <main>
        <section class="help-section">
          <button class="help-toggle" id="help-toggle" aria-expanded="false" aria-controls="help-content">
            <span class="help-icon">‚ùì</span>
            <span class="help-text">
              <strong>Como obter os PDFs do E-trade?</strong>
              <small>Clique aqui para ver instru√ß√µes detalhadas</small>
            </span>
            <span class="help-arrow">‚ñº</span>
          </button>

          <div class="help-content" id="help-content" aria-hidden="true">
            <div class="help-grid">
              <div class="help-card">
                <h3>üìà PDFs de Confirma√ß√£o de Vesting (Release)</h3>
                <div class="help-steps">
                  <div class="step">
                    <span class="step-number">1</span>
                    <div class="step-content">
                      <strong>Acesse o E*TRADE Stock Plan</strong>
                      <p>V√° para: <a href="https://us.etrade.com/etx/sp/stockplan/#/myAccount/stockPlanConfirmations" target="_blank" rel="noopener noreferrer">Stock Plan Confirmations</a></p>
                    </div>
                  </div>
                  <div class="step">
                    <span class="step-number">2</span>
                    <div class="step-content">
                      <strong>Baixe os PDFs de Release</strong>
                      <p>Fa√ßa download das confirma√ß√µes de vesting dos anos que deseja processar</p>
                    </div>
                  </div>
                  <div class="step">
                    <span class="step-number">3</span>
                    <div class="step-content">
                      <strong>Organize em uma pasta</strong>
                      <p>Coloque todos os PDFs em uma pasta (pode usar subpastas por ano/m√™s)</p>
                    </div>
                  </div>
                </div>
                <div class="help-demo">
                  <img src="../docs/gif/download-release-confirmation.gif" alt="Como baixar confirma√ß√µes de release" loading="lazy" />
                  <p class="help-caption">Demonstra√ß√£o: Download de confirma√ß√µes de vesting</p>
                </div>
              </div>

              <div class="help-card">
                <h3>üìâ PDFs de Confirma√ß√£o de Venda (Trade)</h3>
                <div class="help-steps">
                  <div class="step">
                    <span class="step-number">1</span>
                    <div class="step-content">
                      <strong>Acesse E*TRADE Documents</strong>
                      <p>V√° para: <a href="https://us.etrade.com/etx/pxy/accountdocs-statements#/documents" target="_blank" rel="noopener noreferrer">Account Documents</a></p>
                    </div>
                  </div>
                  <div class="step">
                    <span class="step-number">2</span>
                    <div class="step-content">
                      <strong>Baixe os PDFs de Trade</strong>
                      <p>Fa√ßa download das confirma√ß√µes de venda dos anos que deseja processar</p>
                    </div>
                  </div>
                  <div class="step">
                    <span class="step-number">3</span>
                    <div class="step-content">
                      <strong>Organize em uma pasta</strong>
                      <p>Coloque todos os PDFs em uma pasta separada (pode usar subpastas)</p>
                    </div>
                  </div>
                </div>
                <div class="help-demo">
                  <img src="../docs/gif/download-trade-confirmation.gif" alt="Como baixar confirma√ß√µes de trade" loading="lazy" />
                  <p class="help-caption">Demonstra√ß√£o: Download de confirma√ß√µes de venda</p>
                </div>
              </div>

            </div>

            <div class="help-tips">
              <h4>üí° Dicas Importantes:</h4>
              <ul>
                <li><strong>Organize por ano:</strong> Crie subpastas para cada ano (2023/, 2024/, etc.)</li>
                <li><strong>Busca recursiva:</strong> O sistema procura PDFs em todas as subpastas automaticamente</li>
                <li><strong>Nomes de arquivo:</strong> N√£o importa o nome - o sistema l√™ o conte√∫do do PDF</li>
                <li><strong>Pasta vazia:</strong> Se n√£o tiver vendas, n√£o precisa selecionar nada no campo de Trade</li>
                <li><strong>Privacidade:</strong> Todos os PDFs s√£o processados localmente no seu navegador</li>
              </ul>
            </div>
          </div>
        </section>

        <section class="upload-section" id="upload-section">
          <h2>üìÅ Carregar Dados do Portf√≥lio</h2>

          <div class="upload-group">
            <label for="release-pdfs">
              üìà PDFs de Confirma√ß√£o de Vesting
              <span class="label-hint">Arquivos individuais ou pasta completa</span>
            </label>
            <div class="file-input-wrapper">
              <input 
                type="file" 
                id="release-pdfs" 
                accept=".pdf" 
                multiple 
                webkitdirectory 
                directory 
                class="hidden-input" 
                aria-label="Selecionar PDFs de confirma√ß√£o de vesting" 
              />
              <button 
                type="button" 
                id="release-btn" 
                class="file-select-btn" 
                aria-label="Escolher arquivos ou pasta de vesting"
              >
                üìÑ Escolher Arquivos ou Pasta
              </button>
              <span id="release-count" class="file-count" role="status" aria-live="polite"></span>
            </div>
            <small>
              üí° <strong>Dica:</strong> Selecione a pasta que cont√©m todos os PDFs de vesting. 
              O sistema processar√° automaticamente todos os arquivos, incluindo subpastas.
            </small>
          </div>

          <div class="upload-group">
            <label for="trade-pdfs">
              üìâ PDFs de Confirma√ß√£o de Venda (Trade)
              <span class="label-hint">Arquivos individuais ou pasta completa</span>
            </label>
            <div class="file-input-wrapper">
              <input 
                type="file" 
                id="trade-pdfs" 
                accept=".pdf" 
                multiple 
                webkitdirectory 
                directory 
                class="hidden-input" 
                aria-label="Selecionar PDFs de confirma√ß√£o de venda" 
              />
              <button 
                type="button" 
                id="trade-btn" 
                class="file-select-btn" 
                aria-label="Escolher arquivos ou pasta de vendas"
              >
                üìÑ Escolher Arquivos ou Pasta
              </button>
              <span id="trade-count" class="file-count" role="status" aria-live="polite"></span>
            </div>
            <small>
              üí° <strong>Dica:</strong> Selecione a pasta que cont√©m todos os PDFs de vendas. 
              Todas as subpastas ser√£o processadas recursivamente.
            </small>
          </div>

          <div class="upload-group">
            <label for="json-file">
              üìù Arquivo JSON de Opera√ß√µes
              <span class="label-hint">Opcional - Para opera√ß√µes manuais</span>
            </label>
            <input 
              type="file" 
              id="json-file" 
              accept=".json" 
              aria-label="Selecionar arquivo JSON de opera√ß√µes" 
            />
            <small>
              ‚ÑπÔ∏è Use este campo para adicionar opera√ß√µes manualmente via JSON. 
              √ötil para importar dados de outras fontes ou fazer ajustes.
            </small>
          </div>

          <div class="button-group">
            <button 
              id="process-btn" 
              class="primary" 
              disabled 
              aria-label="Processar dados do portf√≥lio"
            >
              ‚ö° Processar Portf√≥lio
            </button>
            <button 
              id="export-btn" 
              class="primary" 
              disabled 
              aria-label="Processar portf√≥lio e exportar para CSV"
            >
              üìä Processar e Exportar CSV
            </button>
            <button 
              id="clear-btn" 
              class="secondary" 
              aria-label="Limpar todos os dados carregados"
            >
              üóëÔ∏è Limpar Tudo
            </button>
          </div>
        </section>

        <section class="reset-section" id="reset-section" style="display: none;">
          <button id="reset-btn" class="reset-button">
            <span class="reset-icon">üîÑ</span>
            <span class="reset-text">
              <strong>Processar Novos Dados</strong>
              <small>Limpar resultados atuais e recome√ßar</small>
            </span>
          </button>
        </section>

        <section 
          id="results" 
          role="region" 
          aria-live="polite" 
          aria-label="Resultados do processamento"
        ></section>
      </main>

      <footer class="site-footer">
        <div class="disclaimer-box">
          <div class="disclaimer-icon">‚ö†Ô∏è</div>
          <div class="disclaimer-content">
            <h3>Aviso Legal Importante</h3>
            <p>
              <strong>Este sistema √© uma ferramenta auxiliar e educacional.</strong> 
              As informa√ß√µes e c√°lculos apresentados n√£o substituem a necessidade de an√°lise individual 
              e orienta√ß√£o profissional. O uso adequado deste programa √© de responsabilidade de cada usu√°rio.
            </p>
            <p>
              <strong>√â sempre recomendado consultar um contador qualificado</strong> para orienta√ß√£o 
              fiscal precisa e atualizada sobre suas obriga√ß√µes tribut√°rias, especialmente para 
              declara√ß√£o de Imposto de Renda (IRPF).
            </p>
          </div>
        </div>
        
        <div class="footer-info">
          <p>
            <strong>Stock Portfolio Manager</strong> ‚Ä¢ 
            Sistema de c√≥digo aberto para gest√£o de investimentos
          </p>
          <p style="margin-top: 8px; opacity: 0.8;">
            Desenvolvido com üíô ‚Ä¢ 
            <a href="https://github.com/miguelslemos/stock_portfolio" target="_blank" rel="noopener noreferrer">
              GitHub
            </a>
          </p>
        </div>
      </footer>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
